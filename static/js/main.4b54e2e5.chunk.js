(this.webpackJsonpbarcode=this.webpackJsonpbarcode||[]).push([[0],{16:function(t,e,n){},17:function(t,e,n){},23:function(t,e,n){"use strict";n.r(e);var r=n(2),o=n.n(r),i=n(11),c=n.n(i),a=(n(16),function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,26)).then((function(e){var n=e.getCLS,r=e.getFID,o=e.getFCP,i=e.getLCP,c=e.getTTFB;n(t),r(t),o(t),i(t),c(t)}))}),u=n(5),d=(n(17),n(25)),l=n(3);var s=function(t){var e=Object(r.useRef)(),n=Object(r.useRef)(),o=Object(r.useRef)(),i=Object(r.useState)([0,0]),c=Object(u.a)(i,2),a=c[0],s=c[1],g=Object(r.useState)(""),h=Object(u.a)(g,2),f=h[0],v=h[1],w=Object(r.useState)(!0),p=Object(u.a)(w,2),b=p[0],y=p[1];Object(r.useEffect)((function(){var t=!0;console.log("Set interval");var e=setInterval((function(){t?requestAnimationFrame(S):console.log("Unmounted reader call")}),200);return function(){console.log("Clear interval for reader"),t=!1,clearInterval(e)}}),[]),Object(r.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",zoom:!0}}).then((function(t){console.log(t),console.log("TEST");try{e.current.srcObject=t,e.current.setAttribute("playsinline",!0),e.current.play()}catch(n){}})),console.log(window.innerWidth.toString()+"x"+window.innerHeight.toString())}),[e]),Object(r.useEffect)((function(){if(o&&o.current){var t=o.current.getContext("2d"),n=e.current.videoWidth,r=e.current.videoHeight;console.log("Resolution changed "+n.toString()+"x"+r.toString()),x(t,{x:0,y:r/2-75,x1:n,y1:r/2-75},{color:"red",width:5}),x(t,{x:0,y:r/2+75,x1:n,y1:r/2+75},{color:"red",width:5}),x(t,{x:0,y:r/2-75,x1:0,y1:r/2+75},{color:"red",width:5}),x(t,{x:n,y:r-75,x1:n,y1:r/2+75},{color:"red",width:5}),x(t,{x:0,y:3,x1:n,y1:3},{color:"green",width:5}),x(t,{x:3,y:0,x1:3,y1:r},{color:"green",width:5}),x(t,{x:0,y:r-3,x1:n,y1:r-3},{color:"green",width:5}),x(t,{x:n-3,y:0,x1:n-3,y1:r},{color:"green",width:5})}}),[a]);var x=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.x,o=e.y,i=e.x1,c=e.y1,a=n.color,u=void 0===a?"black":a,d=n.width,l=void 0===d?1:d;t.beginPath(),t.moveTo(r,o),t.lineTo(i,c),t.strokeStyle=u,t.lineWidth=l,t.stroke()};function m(t,e,n,r){return r[0]*t[e-n-4]+r[1]*t[e-4]+r[2]*t[e+n-4]-r[0]*t[e-n+4]-r[1]*t[e+4]-r[2]*t[e+4+4]}function j(t,e,n,r){return r[0]*t[e-n-4]+r[1]*t[e-n]+r[2]*t[e-n+4]-(r[0]*t[e+n-4]+r[1]*t[e+n]+r[2]*t[e+n+4])}function O(t){var e=t.getContext("2d"),n=e.getImageData(0,0,t.width,t.height);!function(t,e){for(var n=t.data,r=4*t.width,o=n.length-r-4,i=new n.constructor(new ArrayBuffer(n.length)),c=r+4;c<o;c+=4){var a=m(n,c,r,e),u=j(n,c,r,e);i[c]=i[c+1]=i[c+2]=Math.sqrt(a*a+u*u),i[c+3]=255}t.data.set(i)}(n,[1,2,1]),e.putImageData(n,0,0)}var C=120;function S(){if(e&&e.current){console.log(e.current.videoHeight.toString()+"x"+e.current.videoWidth);var t=e.current.videoWidth,r=e.current.videoHeight;if(n.current.height=t,n.current.width=r,t*r!==0)n.current.getContext("2d").drawImage(e.current,0,0,n.current.width,n.current.height),O(n.current),function(t){var e,n,r=t.getContext("2d"),o=r.getImageData(0,0,t.width,t.height),i=o.data,c=o.width,a=o.height,u=c*a,d=new i.constructor(new ArrayBuffer(i.length)),l=new Array(i.length),s=o.width/2,g=o.height/2;for(e=0;e<u;e+=1)l[e]=0;e=0;for(var h=0;h<a;h+=1)for(var f=0;f<c;f+=1,e+=4)if(i[e]>C){var w=f-s,p=h-g;for(n=0;n<c;n+=5){var b=((n-s)/s+1)*Math.PI/2,y=Math.cos(b),x=Math.sin(b),m=parseInt((w*y+p*x)/2)+g;m>=a&&(m=a-1),m<0&&(m=0),l[m*c+parseInt(n/5)]+=1}}n=0;var j=new Array(a);for(e=0;e<a;e++)j[e]=0;for(e=0;e<u;e++,n+=4){var O=parseInt(e/c);d[n]=d[n+1]=d[n+2]=l[e],d[n+3]=255,O>c/2-.2*c&&O<c/2+.2*c&&(j[parseInt(e/c)]+=l[e])}var S=0,I=0,T=a;for(e=0;e<T;e++)S+=j[e],I+=j[e]*j[e];var A=S/T,E=I/T-A*A,D=.2*T,P=0;for(e=parseInt(T/2-D);e<T/2+D;e++)P+=j[e];P/=2*D,v(A.toString()+", "+E.toString()+" ("+P.toString()+" "+(P/A).toString()+")"),o.data.set(d),r.putImageData(o,0,0)}(n.current)}}function I(t){if(console.log("Image Captured"),t.target.files&&t.target.files.length>0){var e=t.target.files[0];console.log(e),console.log(e.type),v(e.type+" "+e.size.toString()),function(t){return new Promise((function(e,n){var r=new FileReader;r.readAsDataURL(t),r.onload=function(){return e(r.result)},r.onerror=function(t){return n(t)}}))}(e).then((function(t){Object(d.a)({method:"post",mode:"no-cors",crossDomain:"true",url:"https://10.0.0.68:8080/uploadImage",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json","Access-Control-Allow-Methods":"GET, PUT, POST, DELETE, OPTIONS"},withCredentials:!1,credentials:"same-origin",data:{image:t}})}))}}return Object(l.jsxs)("div",{children:[Object(l.jsx)("input",{type:"file",id:"barcodeScan",accept:"image/*",capture:"environment",onChange:function(t){return I(t)}}),Object(l.jsx)("div",{id:"text",children:f}),Object(l.jsx)("button",{type:"button",onClick:function(){return function(){console.log("Capture");var t=n.current.getContext("2d"),r=e.current.videoWidth,i=e.current.videoHeight;n.current.width=r,n.current.height=i,t.drawImage(e.current,0,0,n.current.width,n.current.height),o.current.height=e.current.videoHeight,o.current.width=e.current.videoWidth,s([r,i]);var c=n.current.toDataURL("image/png");Object(d.a)({method:"post",mode:"no-cors",crossDomain:"true",url:"https://10.0.0.68:8080/uploadImage",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json","Access-Control-Allow-Methods":"GET, PUT, POST, DELETE, OPTIONS"},withCredentials:!1,credentials:"same-origin",data:{image:c}})}()},children:" Capture "}),Object(l.jsx)("button",{type:"button",onClick:function(){return function(){var t=document.getElementById("canvas");console.log(b),t.style.display=b?"none":"block",y(!b)}()},children:" Toggle "}),Object(l.jsxs)("h3",{children:["v ","0.1.1"]})]})};c.a.render(Object(l.jsx)(o.a.StrictMode,{children:Object(l.jsx)(s,{})}),document.getElementById("root")),a()}},[[23,1,2]]]);
//# sourceMappingURL=main.4b54e2e5.chunk.js.map